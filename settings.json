{
  "$schema": "https://raw.githubusercontent.com/anthropics/claude-code/main/schemas/settings.schema.json",
  "description": "Template de configura√ß√£o de hooks para projetos React/TypeScript. Copie este arquivo para .claude/settings.local.json em outros projetos e ajuste conforme necess√°rio.",

  "enabledPlugins": {
    "playwright@claude-plugins-official": true
  },

  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "echo \"[$(date '+%Y-%m-%d %H:%M:%S')] Bash: $(jq -r '.tool_input.command // \"no command\"')\" >> ~/.claude/bash-command-log.txt || true"
          }
        ]
      }
    ],

    "PostToolUse": [
      {
        "matcher": "Write|Edit|MultiEdit",
        "timeout": 90,
        "hooks": [
          {
            "type": "command",
            "command": "file_path=$(echo '{}' | jq -r '.tool_input.file_path // empty'); if [[ -n \"$file_path\" && \"$file_path\" =~ \\.(js|jsx|ts|tsx)$ ]]; then echo \"[$(date '+%Y-%m-%d %H:%M:%S')] üé® Prettier: $file_path\" >> ~/.claude/command-log.txt; project_dir=\"$(dirname \"$file_path\")\"; while [[ \"$project_dir\" != \"/\" && ! -f \"$project_dir/package.json\" ]]; do project_dir=\"$(dirname \"$project_dir\")\"; done; if [[ -f \"$project_dir/package.json\" ]]; then cd \"$project_dir\" && npx prettier --write \"$file_path\" 2>&1 | tee -a ~/.claude/command-log.txt; else echo \"No package.json found\" >> ~/.claude/command-log.txt; fi; fi || true",
            "timeout": 30,
            "description": "Formata c√≥digo JavaScript/TypeScript com Prettier"
          },
          {
            "type": "command",
            "command": "file_path=$(echo '{}' | jq -r '.tool_input.file_path // empty'); if [[ -n \"$file_path\" && \"$file_path\" =~ \\.(ts|tsx)$ ]]; then echo \"[$(date '+%Y-%m-%d %H:%M:%S')] üîç ESLint: $file_path\" >> ~/.claude/command-log.txt; project_dir=\"$(dirname \"$file_path\")\"; while [[ \"$project_dir\" != \"/\" && ! -f \"$project_dir/package.json\" ]]; do project_dir=\"$(dirname \"$project_dir\")\"; done; if [[ -f \"$project_dir/package.json\" ]]; then cd \"$project_dir\" && npm run lint -- \"$file_path\" 2>&1 | tee -a ~/.claude/command-log.txt || echo \"‚ö†Ô∏è ESLint warnings/errors found\" >> ~/.claude/command-log.txt; else echo \"No package.json found\" >> ~/.claude/command-log.txt; fi; fi || true",
            "timeout": 30,
            "description": "Valida c√≥digo com ESLint"
          },
          {
            "type": "command",
            "command": "file_path=$(echo '{}' | jq -r '.tool_input.file_path // empty'); if [[ -n \"$file_path\" && \"$file_path\" =~ \\.(ts|tsx)$ ]]; then echo \"[$(date '+%Y-%m-%d %H:%M:%S')] üìù TypeCheck: running...\" >> ~/.claude/command-log.txt; project_dir=\"$(dirname \"$file_path\")\"; while [[ \"$project_dir\" != \"/\" && ! -f \"$project_dir/package.json\" ]]; do project_dir=\"$(dirname \"$project_dir\")\"; done; if [[ -f \"$project_dir/package.json\" ]]; then cd \"$project_dir\" && npm run type-check 2>&1 | tail -20 | tee -a ~/.claude/command-log.txt || echo \"‚ö†Ô∏è Type errors found\" >> ~/.claude/command-log.txt; else echo \"No package.json found\" >> ~/.claude/command-log.txt; fi; fi || true",
            "timeout": 45,
            "description": "Verifica tipos TypeScript"
          },
          {
            "type": "command",
            "command": "file_path=$(echo '{}' | jq -r '.tool_input.file_path // empty'); if [[ -n \"$file_path\" && \"$file_path\" =~ \\.(ts|tsx)$ && ! \"$file_path\" =~ \\.test\\.(ts|tsx)$ ]]; then echo \"[$(date '+%Y-%m-%d %H:%M:%S')] üß™ Tests: running related tests...\" >> ~/.claude/command-log.txt; project_dir=\"$(dirname \"$file_path\")\"; while [[ \"$project_dir\" != \"/\" && ! -f \"$project_dir/package.json\" ]]; do project_dir=\"$(dirname \"$project_dir\")\"; done; if [[ -f \"$project_dir/package.json\" ]]; then cd \"$project_dir\" && npm test -- --run --reporter=verbose 2>&1 | tail -30 | tee -a ~/.claude/command-log.txt || echo \"‚ö†Ô∏è Some tests failed or no tests found\" >> ~/.claude/command-log.txt; else echo \"No package.json found\" >> ~/.claude/command-log.txt; fi; fi || true",
            "timeout": 60,
            "description": "Executa testes relacionados"
          }
        ]
      }
    ]
  },

  "permissions": {
    "bash": {
      "allowed": [
        "mcp__serena__read_memory",
        "npm test",
        "npm run lint",
        "npm run lint:fix",
        "npm run lint:ci",
        "npm run type-check",
        "npm run test:coverage",
        "npm run test:ui",
        "npm run dev",
        "npm run build",
        "npm run preview",
        "git add",
        "git commit",
        "git push",
        "git status",
        "git rev-parse",
        "git log",
        "git diff",
        "gh pr create",
        "glab mr create"
      ]
    }
  },

  "_notes": {
    "description": "Notas sobre este template:",
    "requirements": [
      "Git Bash ou WSL no Windows",
      "jq instalado (geralmente vem com Git Bash)",
      "Projeto com package.json",
      "Scripts: lint, type-check, test no package.json"
    ],
    "customization": [
      "Ajuste os timeouts conforme o tamanho do projeto",
      "Adicione/remova hooks conforme necess√°rio",
      "Modifique os padr√µes de arquivo (regex) se usar outras extens√µes",
      "Atualize a lista de permiss√µes bash conforme seus scripts"
    ],
    "logs": [
      "~/.claude/command-log.txt - Valida√ß√µes p√≥s-edi√ß√£o",
      "~/.claude/bash-command-log.txt - Comandos Bash executados"
    ]
  }
}
